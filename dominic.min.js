!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():e.CreateElement=t()}(this,function(){var e=window,t=[],r={},n=function(t){return t instanceof e.Node},o=function(e){var t=typeof e;return"object"===t||"function"===t},a=function(e){var t=typeof e;return"string"===t||"number"===t},i=function(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},f=function(e){e=e||{};for(var t=1;t<arguments.length;t++)for(var r=arguments[t],n=Object.keys(arguments[t]),o=0;o<n.length;o++)e[n[o]]=r[n[o]];return e},u=function(e){if(e=e||{},arguments.length<2)return e;var t=arguments[arguments.length-1];if("string"!=typeof t)return e;var r=t.split(",");if(!r.length)return e;for(var n=1;n<arguments.length-1;n++)for(var o=arguments[n],a=Object.keys(arguments[n]),i=0;i<a.length;i++){var f=a[i];if(-1!==r.indexOf(f)){var u=o[f];e[f]=u}}return e},l=function(e){e=e||{};for(var t=1;t<arguments.length;t++)for(var r=arguments[t],n=Object.keys(arguments[t]),o=0;o<n.length;o++){var a=n[o];if(Array.isArray(e))for(k=0;k<e.length;k++)e[k].hasOwnProperty(a)||(e[k][a]=r[a]);else e.hasOwnProperty(a)||(e[a]=r[a])}return e},s=function(e){var r=e.id?"#"+e.id:"",n=e.classList.toString(),o=n?n.split(" "):t,a=e.localName+r+(o.length?"."+o.join("."):"");return a},c=function(e,t,r){for(;t!==e;){if(t.matches(r))return t;t=t.parentNode}return null},p=function(t,r,n){r=r||{};var o=r.el||e.document.documentElement,a=r.callback,i=r.capture||!1,f=r.delegate,u=function(e){if("string"==typeof f){if(o===e.target)return;var t=c(o,e.target,f);if(!t)return;"function"==typeof a&&a.call(t,e)}else"function"==typeof a&&a.call(n,e)};return u.destroy=function(){return this.el=null,o.removeEventListener(t,u,i)},u.el=o,u.type=t,u.capture=i,o.addEventListener(t,u,i),u},v=Object.defineProperties,h=Object.defineProperty,d=function(){var e=function(){Array.call(this)};return e.prototype=Object.create(Array.prototype),v(e.prototype,{remove:{value:function(e){if("function"!=typeof e)return!1;for(var t=[],r=0,n=0;n<this.length;n++)e.call(null,this[n])&&t.push(this[n]);for(var o=0;o<t.length;o++){var a=t[o];a.destroy(),this.splice(this.indexOf(a),1),r++}return r==t.length}},removeEvent:{value:function(e,t,r){var n=this,o=[];return this.forEach(function(n){"*"!==e&&n.type!==e||"*"!==t&&n.el!==t||r&&n.capture!==r||o.push(n)}),o.forEach(function(e){e.destroy(),n.splice(n.indexOf(e),1)}),o.length}},removeAll:{value:function(){for(var e=0;e<this.length;e++)this[e].destroy();this.length=0}}}),e}(),y=function(){var e=function(){};return e.prototype=Object.create(Object.prototype),v(e.prototype,{remove:{value:function(e){if("function"!=typeof e)return!1;for(var t=Object.keys(this),r=0,n=0;n<t.length;n++){var o=t[n];e.call(null,this[o],o)&&(r+=delete this[o]?1:0)}return r==t.length}},removeRef:{value:function(e){return this.hasOwnProperty(e)?delete this[e]:!1}},removeAll:{value:function(){for(var e=Object.keys(this),t=0;t<e.length;t++)delete this[e[t]];return t===e.length}}}),e}(),g=function(){var e=function(e){if("undefined"==typeof e)throw new Error("No root provided");this.__owner=e};return e.prototype=Object.create(Object.prototype),v(e.prototype,{add:{value:function(e,t){var r=t.update?t.update.observeProp:"";if(!r||"__owner"===r||!a(r))return!1;var n=u({},t,{appendTo:e,obsProp:r},"tplFn,for,root,appendTo,obsProp,update");h(this,r,{set:function(t){for(n["for"]=t;e.firstChild;){var r=e.removeChild(e.firstChild);this.__owner.evts.remove(function(e){return r.contains(e.el)}),this.__owner.refs.remove(function(e,t){return r===e||r.contains(e)})}var o=b(e,n,this.__owner);O(e,o,this.__owner)}})}}}),e}(),m=function(e,t,r){var n=t.ref;if(a(n)){var o=t.refScope,i="parent"===o?e:r;i.refs=i.refs||new y,i.refs[n]=t}},b=function(e,t,r){var n,o=t["for"],a=t.root||"",i=a?o[a]:o,f=t.tplFn;if(i&&"function"==typeof f){var u=t.scope,l="root"===u?r:"parent"===u?e:u;n=Array.isArray(i)?i.map(f,l):f.call(l,i)}return n},w=function(e,t,r){r.observe=r.observe||new g(r),r.observe.add(e,t)},O=function(e,t,r,a){"use strict";if(o(t))if(n(t))e.appendChild(t),m(e,t,r);else if("function"==typeof t){var i=t();a&&l(i,a),O(e,i,r,a)}else if(Array.isArray(t))for(var f=0;f<t.length;f++){var u=t[f];a&&l(u,a),O(e,u,r,a)}else{var s=t.tag;if(s){delete t.tag,a&&l(t,a);var c=U(s,t,r);O(e,c,r,a)}else if(t.hasOwnProperty("for")){if(!o(t["for"]))return;var p=b(e,t,r);O(e,p,r,a),o(t.update)&&w(e,t,r)}else{var v=t.fn;if("function"==typeof v){var h=t.scope,d="root"===h?r:"parent"===h?e:h,y=v.call(d);O(e,y,r,a)}}}},j=function(e,t,r){var n=t.type;if(!n)throw new Error("No event type specified");var o,a=t.handler,i=typeof a;r=r||e;var f="root"===t.scope?r:t.scope?t.scope:e;if("function"===i?o=a:"string"===i&&(o=f[a]),"function"!=typeof o)throw new Error('Cannot find handler: "'+a+'" on element: ['+s(f)+"].");var u=t.capture,l=t.delegate,c=p(n,{el:e,callback:o,capture:u,delegate:l},f);r.evts=r.evts||new d,r.evts.push(c)},A=function(e,t,r){if(Array.isArray(t))for(var n=0;n<t.length;n++)j(e,t[n],r);else j(e,t,r)},x=function(e,t){for(var r=Object.keys(t),n=0;n<r.length;n++){var o=r[n],a=t[o];e.setAttribute(i(o),a)}},_=function(e,t){for(var r=Object.keys(t),n=0;n<r.length;n++){var o=r[n],a=t[o];e.style[o]=isNaN(a)?a:a+"px"}},C={setevents:A,setattrs:x,setstyle:_,setchildren:O,setitems:O},E=function(e,t){for(var r=Object.keys(t),n=r.length,o=0;n>o;o++){var a=r[o],i=t[a];e[a]=(e[a]+i).trim()}},N=function(e,t,r,n){for(var o=0,a=t.length;a>o;o++){var i=t[o];C["set"+i.key](e,i.val,r,n)}},P=function(e,t,r){for(var n=0,o=t.length;o>n;n++){var a=t[n],i=f({},{type:a.key},a.val);j(e,i,r)}},L=function(e){var t;return t="function"==typeof e?e():e,Boolean(t)},T=["width","height","maxWidth","maxHeight","padding","margin"],F=["color","backgroundColor","background","display","position","opacity"],S=["defaults"],W=["style","children","items","attrs","events"],$=["click","mousedown","mouseup","mouseover","mouseout","mouseenter","mouseleave","dragstart","dragend","drag","dragover","dragenter","dragout","drop","blur","focus","keydown","keypress","keyup","change","input","submit","touchstart","touchmove","touchend","wheel","scroll"],z=["created","appended"],B=["className","id"],H=["text","textContent"],R=["parent"],Z=T.concat(F,S,W,$,z,B,H,R),q=T.length,D=q+F.length,G=D+S.length,I=G+W.length,J=I+$.length,K=J+z.length,M=K+B.length,Q=M+H.length,U=function(t,o,a,i){o=o||r;var u=e.document.createElement(t);a=a||u;var l,s,c,p,v,h,d,y=Object.keys(o);if(o.hasOwnProperty("if")&&!L(o["if"]))return null;o.hasOwnProperty("hide")&&L(o.hide)&&(d=!0);for(var g=0,m=y.length;m>g;g++){var b=y[g],w=o[b],k=Z.indexOf(b);-1==k?u[b]=w:q>k?u.style[b]=isNaN(w)?w:w+"px":D>k?u.style[b]=w:G>k?f(h=h||{},w):I>k?(l=l||[]).push({key:b,val:w}):J>k?(s=s||[]).push({key:b,val:w}):K>k?(c=c||{})[b]=w:M>k?(p=p||{})[b]=w:Q>k?u.appendChild(e.document.createTextNode(w)):v=w}return p&&E(u,p),l&&N(u,l,a,h),s&&P(u,s,a),c&&"function"==typeof c.created&&c.created.call(u),v&&n(v)&&u===a&&(v.appendChild(u),c&&"function"==typeof c.appended&&c.appended.call(u,v)),d&&(u.style.display="none"),u},V=function(e,t){return U(e,t)};return V.setWindow=function(t){e=t},V});